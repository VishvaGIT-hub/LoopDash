<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#000000">
    <meta name="description" content="Loop Dash Ultra 3D - The most advanced endless runner game">
    
    <title>Loop Dash Ultra 3D - Next Gen Endless Runner</title>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/animations.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loader" class="loader active">
        <div class="loader-background">
            <canvas id="loaderCanvas"></canvas>
        </div>
        <div class="loader-content">
            <div class="game-logo">
                <h1 class="logo-text">
                    <span class="text-3d" data-text="LOOP">LOOP</span>
                    <span class="text-3d" data-text="DASH">DASH</span>
                    <span class="text-ultra" data-text="ULTRA">ULTRA 3D</span>
                </h1>
            </div>
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                    <div class="progress-glow"></div>
                </div>
                <div class="loading-info">
                    <span class="loading-text" id="loadingText">Initializing 3D Engine...</span>
                    <span class="loading-percent" id="loadingPercent">0%</span>
                </div>
                <div class="loading-tip">
                    <span class="tip-icon">üí°</span>
                    <span class="tip-text" id="loadingTip">Swipe to perform amazing moves!</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Menu Screen -->
    <div id="mainMenu" class="screen">
        <canvas id="menuBackground"></canvas>
        
        <div class="menu-container">
            <!-- Top Bar -->
            <header class="menu-header">
                <div class="player-card">
                    <div class="player-avatar">
                        <canvas id="avatarCanvas" width="80" height="80"></canvas>
                        <div class="player-level" id="playerLevel">1</div>
                    </div>
                    <div class="player-info">
                        <h3 class="player-name" id="playerName">RUNNER</h3>
                        <div class="xp-bar">
                            <div class="xp-fill" id="xpFill"></div>
                        </div>
                        <p class="player-rank" id="playerRank">Beginner</p>
                    </div>
                </div>

                <div class="currencies">
                    <div class="currency coins">
                        <span class="icon">üí∞</span>
                        <span class="amount" id="coinsAmount">0</span>
                        <button class="add-btn">+</button>
                    </div>
                    <div class="currency gems">
                        <span class="icon">üíé</span>
                        <span class="amount" id="gemsAmount">0</span>
                        <button class="add-btn">+</button>
                    </div>
                    <div class="currency energy">
                        <span class="icon">‚ö°</span>
                        <span class="amount" id="energyAmount">5/5</span>
                    </div>
                </div>

                <button class="settings-btn" id="settingsBtn">‚öôÔ∏è</button>
            </header>

            <!-- Character Showcase -->
            <div class="character-showcase">
                <canvas id="characterCanvas" class="character-canvas"></canvas>
                <div class="character-controls">
                    <button class="rotate-btn" id="rotateLeft">‚ü≤</button>
                    <button class="rotate-btn" id="rotateRight">‚ü≥</button>
                </div>
                <div class="character-stats">
                    <div class="stat">
                        <span class="stat-icon">‚ö°</span>
                        <span class="stat-name">Speed</span>
                        <div class="stat-bar"><div class="stat-fill" style="width:85%"></div></div>
                        <span class="stat-value">85</span>
                    </div>
                    <div class="stat">
                        <span class="stat-icon">ü¶ò</span>
                        <span class="stat-name">Jump</span>
                        <div class="stat-bar"><div class="stat-fill" style="width:90%"></div></div>
                        <span class="stat-value">90</span>
                    </div>
                    <div class="stat">
                        <span class="stat-icon">üçÄ</span>
                        <span class="stat-name">Luck</span>
                        <div class="stat-bar"><div class="stat-fill" style="width:75%"></div></div>
                        <span class="stat-value">75</span>
                    </div>
                </div>
                <button class="customize-btn" id="customizeBtn">
                    <span class="btn-icon">üé®</span>
                    <span class="btn-text">CUSTOMIZE</span>
                </button>
            </div>

            <!-- Main Play Button -->
            <button class="btn-play" id="playBtn">
                <div class="btn-glow"></div>
                <span class="btn-icon">‚ñ∂</span>
                <span class="btn-text">PLAY NOW</span>
            </button>

            <!-- Game Modes -->
            <div class="game-modes">
                <button class="mode-btn" data-mode="classic">
                    <span class="mode-icon">üèÉ</span>
                    <span class="mode-name">Classic</span>
                </button>
                <button class="mode-btn" data-mode="timeattack">
                    <span class="mode-icon">‚è±Ô∏è</span>
                    <span class="mode-name">Time Attack</span>
                </button>
                <button class="mode-btn" data-mode="tournament">
                    <span class="mode-icon">üèÜ</span>
                    <span class="mode-name">Tournament</span>
                    <span class="mode-badge">LIVE</span>
                </button>
            </div>

            <!-- Quick Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <span class="icon">üèÜ</span>
                    <span class="value" id="highScore">0</span>
                    <span class="label">Best Score</span>
                </div>
                <div class="stat-card">
                    <span class="icon">üìè</span>
                    <span class="value" id="totalDistance">0km</span>
                    <span class="label">Distance</span>
                </div>
                <div class="stat-card">
                    <span class="icon">üî•</span>
                    <span class="value" id="winStreak">0</span>
                    <span class="label">Streak</span>
                </div>
            </div>

            <!-- Daily Missions Widget -->
            <div class="missions-widget">
                <div class="widget-header">
                    <h3>Daily Missions</h3>
                    <span class="timer" id="missionTimer">23:45:12</span>
                </div>
                <div class="mission-list" id="missionList"></div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <button class="nav-btn active" data-screen="menu">
                <span class="nav-icon">üè†</span>
                <span class="nav-label">Home</span>
            </button>
            <button class="nav-btn" data-screen="shop">
                <span class="nav-icon">üõí</span>
                <span class="nav-label">Shop</span>
            </button>
            <button class="nav-btn" data-screen="customize">
                <span class="nav-icon">üé®</span>
                <span class="nav-label">Customize</span>
            </button>
            <button class="nav-btn" data-screen="profile">
                <span class="nav-icon">üë§</span>
                <span class="nav-label">Profile</span>
            </button>
        </nav>
    </div>

    <!-- Game Screen -->
    <div id="gameScreen" class="screen">
        <canvas id="gameCanvas"></canvas>
        
        <!-- Game HUD -->
        <div class="game-hud">
            <div class="hud-top">
                <button class="pause-btn" id="pauseBtn">‚è∏</button>
                
                <div class="score-display">
                    <span class="score-label">SCORE</span>
                    <span class="score-value" id="scoreValue">0</span>
                    <div class="multiplier" id="multiplier">√ó1</div>
                </div>

                <div class="distance-display">
                    <span class="distance-icon">üìè</span>
                    <span class="distance-value" id="distanceValue">0</span>
                    <span class="distance-unit">m</span>
                </div>

                <div class="coins-display">
                    <span class="coins-icon">üí∞</span>
                    <span class="coins-value" id="coinsValue">0</span>
                </div>
            </div>

            <div class="hud-center">
                <div class="combo-display hidden" id="comboDisplay">
                    <span class="combo-number" id="comboNumber">0</span>
                    <span class="combo-text">COMBO!</span>
                </div>

                <div class="powerup-display hidden" id="powerupDisplay">
                    <span class="powerup-icon" id="powerupIcon"></span>
                    <span class="powerup-name" id="powerupName"></span>
                    <div class="powerup-timer">
                        <div class="powerup-timer-fill" id="powerupTimerFill"></div>
                    </div>
                </div>
            </div>

            <div class="hud-bottom">
                <div class="speed-meter">
                    <div class="speed-gauge">
                        <div class="speed-needle" id="speedNeedle"></div>
                    </div>
                    <span class="speed-value" id="speedValue">0</span>
                    <span class="speed-unit">km/h</span>
                </div>

                <div class="environment-info">
                    <span class="env-icon" id="envIcon">‚òÄÔ∏è</span>
                    <span class="env-name" id="envName">Sunny Day</span>
                </div>
            </div>
        </div>

        <!-- Touch Controls -->
        <div class="touch-controls">
            <div class="touch-area touch-left" id="touchJump">
                <div class="touch-indicator">
                    <span class="touch-icon">‚¨ÜÔ∏è</span>
                    <span class="touch-label">JUMP</span>
                </div>
            </div>
            <div class="touch-area touch-right" id="touchSlide">
                <div class="touch-indicator">
                    <span class="touch-icon">‚¨áÔ∏è</span>
                    <span class="touch-label">SLIDE</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Game Over Modal -->
    <div id="gameOverModal" class="modal">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <h2 class="modal-title">GAME OVER</h2>
            <div class="rank-badge" id="rankBadge">
                <span class="rank-letter">A</span>
                <span class="rank-name">Great</span>
            </div>

            <div class="final-stats">
                <div class="final-stat">
                    <span class="stat-icon">üèÜ</span>
                    <div class="stat-info">
                        <span class="stat-label">Score</span>
                        <span class="stat-value" id="finalScore">0</span>
                    </div>
                </div>
                <div class="final-stat">
                    <span class="stat-icon">üí∞</span>
                    <div class="stat-info">
                        <span class="stat-label">Coins</span>
                        <span class="stat-value" id="finalCoins">0</span>
                    </div>
                </div>
                <div class="final-stat">
                    <span class="stat-icon">üìè</span>
                    <div class="stat-info">
                        <span class="stat-label">Distance</span>
                        <span class="stat-value" id="finalDistance">0m</span>
                    </div>
                </div>
            </div>

            <div class="new-record hidden" id="newRecord">
                üéâ NEW HIGH SCORE! üéâ
            </div>

            <div class="modal-actions">
                <button class="btn-modal btn-play-again" id="playAgainBtn">
                    <span>üîÑ PLAY AGAIN</span>
                </button>
                <button class="btn-modal btn-home" id="homeBtn">
                    <span>üè† HOME</span>
                </button>
            </div>
        </div>
    </div>

    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/cannon@0.6.2/build/cannon.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <!-- Core Engine -->
    <script src="js/core/Engine.js"></script>
    <script src="js/core/Renderer3D.js"></script>
    <script src="js/core/PhysicsWorld.js"></script>
    <script src="js/core/SceneManager.js"></script>
    <script src="js/core/CameraController.js"></script>
    <script src="js/core/LightingSystem.js"></script>
    <script src="js/core/PostProcessing.js"></script>

    <!-- Entities -->
    <script src="js/entities/Player3D.js"></script>
    <script src="js/entities/Obstacle3D.js"></script>
    <script src="js/entities/Collectible3D.js"></script>
    <script src="js/entities/PowerUp3D.js"></script>
    <script src="js/entities/Vehicle3D.js"></script>
    <script src="js/entities/Environment3D.js"></script>

    <!-- Systems -->
    <script src="js/systems/ProceduralGenerator.js"></script>
    <script src="js/systems/WeatherSystem.js"></script>
    <script src="js/systems/ParticleSystem3D.js"></script>
    <script src="js/systems/TrailSystem.js"></script>
    <script src="js/systems/DifficultyAI.js"></script>
    <script src="js/systems/ComboSystem.js"></script>
    <script src="js/systems/MissionSystem.js"></script>
    <script src="js/systems/AchievementSystem.js"></script>
    <script src="js/systems/SeasonSystem.js"></script>

    <!-- Customization -->
    <script src="js/customization/CharacterBuilder.js"></script>
    <script src="js/customization/SkinSystem.js"></script>
    <script src="js/customization/MaterialEditor.js"></script>
    <script src="js/customization/AccessorySystem.js"></script>

    <!-- UI -->
    <script src="js/ui/UIManager.js"></script>
    <script src="js/ui/HUD3D.js"></script>
    <script src="js/ui/MenuSystem.js"></script>
    <script src="js/ui/ModalSystem.js"></script>

    <!-- Managers -->
    <script src="js/managers/GameManager.js"></script>
    <script src="js/managers/SaveManager.js"></script>
    <script src="js/managers/AudioManager.js"></script>
    <script src="js/managers/AnalyticsManager.js"></script>

    <!-- Main Entry Point -->
    <script src="js/main.js"></script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('service-worker.js')
                .then(reg => console.log('Service Worker registered'))
                .catch(err => console.log('Service Worker registration failed'));
        }
    </script>
</body>
</html>
